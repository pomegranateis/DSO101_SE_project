# Use Node 18 Alpine for latest compatibility
FROM node:18-alpine

# Set working directory
WORKDIR /app

# Environment config (optional)
ENV NODE_OPTIONS=--max_old_space_size=4096

# Copy package files and install deps
COPY package.json ./
COPY sync-package-lock ./
RUN npm install

# Copy source files
COPY nodemon.json ./
COPY tsconfig.json ./
COPY src ./src
COPY database ./database

# Add entrypoint if needed (still fine)
COPY docker-entrypoint.sh /docker-entrypoint.sh
RUN chmod +x /docker-entrypoint.sh
ENTRYPOINT [ "/docker-entrypoint.sh" ]

# ðŸ‘‡ Run dev script using ts-node-dev
CMD ["npm", "run", "dev"]
